from unicorn import UC_ARCH_X86, UC_MODE_64
from unicorn import UC_ERR_OK, UC_ERR_FETCH_UNMAPPED
from unicorn.x86_const import (
    UC_X86_REG_RAX, UC_X86_REG_RBX, UC_X86_REG_RCX, UC_X86_REG_RDX,
    UC_X86_REG_RSI, UC_X86_REG_RDI, UC_X86_REG_RSP, UC_X86_REG_RBP,
    UC_X86_REG_RIP, UC_X86_REG_R8, UC_X86_REG_R9, UC_X86_REG_R10,
    UC_X86_REG_R11, UC_X86_REG_R12, UC_X86_REG_R13, UC_X86_REG_R14,
    UC_X86_REG_R15, UC_X86_REG_EFLAGS, UC_X86_REG_EAX, UC_X86_REG_EBX,
    UC_X86_REG_ECX, UC_X86_REG_EDX, UC_X86_REG_ESI, UC_X86_REG_EDI,
    UC_X86_REG_ESP, UC_X86_REG_EBP, UC_X86_REG_EIP, UC_X86_REG_FS,
    UC_X86_REG_CS, UC_X86_REG_SS,
)
from unicorn import (
    UC_PROT_READ, UC_PROT_WRITE, UC_PROT_EXEC, UC_PROT_ALL,
    UC_HOOK_CODE, UC_HOOK_MEM_UNMAPPED, UC_HOOK_INTR,
    UC_MEM_WRITE_UNMAPPED, UC_MEM_READ_UNMAPPED,
)

PAGE_SIZE = 0x1000
STACK_SIZE = 0x100000
STACK_X64 = 0x20000000
STACK_X86 = 0x00300000
TIB_ADDR = 0x7FF00000
FAKE_RET_ADDR = 0xDEAD0000

# Register values
GS_MSR = 0xC0000101
CS_X64 = 0x33
CS_X86 = 0x23
SS_X64 = 0x2B
SS_X86 = 0x2B
FS_X86 = 0x3B

# String read constants
STRING_CHUNK = 64
MAX_STRING_LEN = 4096
